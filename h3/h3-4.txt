>> type newtq

% Tim Cheadle
% Math 446 Homework 3

format long;
steps=10;

% iterate using newton's method
for i=1:steps
  f = 0.54*x(i).^5 - 0.81*x(i).^4 - 0.09*x(i).^3 + 0.43*x(i).^2 - 0.17*x(i) + 0.02;
  fp = 2.7*x(i).^4 - 3.24*x(i).^3 - 0.27*x(i).^2 + 0.86*x(i) - 0.17;
  x(i+1) = x(i) - f/fp;
end
t = x(steps+1);
e = x - t;
for i=1:steps-1
  r(i+1) = (x(i+1) - t) / (x(i) - t)^2;
end
r(1) = 0;
r(steps+1) = 0;

% output the convergence table
a = [x' e' r']

% calculate M
fpr = 2.7*t^4 - 3.24*t^3 - 0.27*t^2 + 0.86*t - 0.17;
fppr = 10.8*t^3 - 9.72*t^2 - 0.54*t + 0.86;
m = fppr/2*fpr

% clear the vectors so we can run again
clear x e r a;

>> x(1)=-2;
>> newtq

a =

  -2.00000000000000  -1.21922359359558                  0
  -1.58518518518519  -0.80440877878077  -0.54114055789096
  -1.26830617788683  -0.48752977148241  -0.75343803139037
  -1.03663890420668  -0.25586249780227  -1.07647600165764
  -0.88349227402955  -0.10271586762514  -1.56900478611207
  -0.80452251565544  -0.02374610925102  -2.25069882251946
  -0.78241243937989  -0.00163603297547  -2.90139681394606
  -0.78078485665680  -0.00000845025238  -3.15707990639883
  -0.78077640663132  -0.00000000022691  -3.17769521101179
  -0.78077640640442                  0                  0
  -0.78077640640442                  0                  0


m =

  -7.53132534744014

>> x(1)=2;
>> newtq
Warning: Divide by zero.
(Type "warning off MATLAB:divideByZero" to suppress this warning.)
> In /home/u5/tcheadle/math/newtq.m at line 16

a =

   2.00000000000000   0.71922359359558                  0
   1.71830985915493   0.43753345275051   0.84583063824337
   1.51220025400546   0.23142384760104   1.20888665201670
   1.37525159852172   0.09447519211730   1.76401211771893
   1.30345331562167   0.02267690921725   2.54067020163839
   1.28247572413809   0.00169931773367   3.30450844987148
   1.28078686840390   0.00001046199948   3.62297648241289
   1.28077640680406   0.00000000039965   3.65131110955662
   1.28077640640442                  0                  0
   1.28077640640442   0.00000000000000                Inf
   1.28077640640442                  0                  0


m =

   3.27314409744014

>> diary off

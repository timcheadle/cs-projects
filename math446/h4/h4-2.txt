type matrix

for i = 1 : n
	sum = 0;
	for j = 1 : n
		a(i,j) = ((i-1)/(n-1))^(j-1);
		sum = sum + a(i,j);
	end
	b(i) = sum;
	b_alt1(i) = sum + (-1^i)*delta;
	b_alt2(i) = sum + delta;
end

A = a;
B = b;
B_alt1 = b_alt1;
B_alt2 = b_alt2;

type gauss

for  j = 1 : n-1
	for i = j+1 : n
		mult = a(i,j)/a(j,j);
		for k = j+1 : n
			a(i,k) = a(i,k) - mult*a(j,k);
		end
		b(i) = b(i) - mult*b(j);
	end
end

type backsolve

for i = n : -1 : 1
	for j = i+1 : n
		b(i) = b(i) - a(i,j)*x(j);
	end
	x(i) = b(i)/a(i,i);
end

type gauss_alt1

for  j = 1 : n-1
	for i = j+1 : n
		mult = a(i,j)/a(j,j);
		for k = j+1 : n
			a(i,k) = a(i,k) - mult*a(j,k);
		end
		b_alt1(i) = b_alt1(i) - mult*b_alt1(j);
	end
end

type backsolve_alt1

for i = n : -1 : 1
	for j = i+1 : n
		b_alt1(i) = b_alt1(i) - a(i,j)*x(j);
	end
	x(i) = b_alt1(i)/a(i,i);
end

type gauss_alt2

for  j = 1 : n-1
	for i = j+1 : n
		mult = a(i,j)/a(j,j);
		for k = j+1 : n
			a(i,k) = a(i,k) - mult*a(j,k);
		end
		b_alt2(i) = b_alt2(i) - mult*b_alt2(j);
	end
end

type backsolve_alt2

for i = n : -1 : 1
	for j = i+1 : n
		b_alt2(i) = b_alt2(i) - a(i,j)*x(j);
	end
	x(i) = b_alt2(i)/a(i,i);
end

type table

for i = 1 : n
        table1(i,1) = (b(i) - b_alt1(i))/b(i);
        table1(i,2) = (x(i) - b_alt1(i))/x(i);
	table1(i,3) = cond(A, inf);
end

for i = 1 : n
        table2(i,1) = (b(i) - b_alt2(i))/b(i);
        table2(i,2) = (x(i) - b_alt2(i))/x(i);
	table2(i,3) = cond(A, inf);
end

n = 11; delta = 10^-14;
matrix
A

A =

  Columns 1 through 3 

   1.00000000000000                  0                  0
   1.00000000000000   0.10000000000000   0.01000000000000
   1.00000000000000   0.20000000000000   0.04000000000000
   1.00000000000000   0.30000000000000   0.09000000000000
   1.00000000000000   0.40000000000000   0.16000000000000
   1.00000000000000   0.50000000000000   0.25000000000000
   1.00000000000000   0.60000000000000   0.36000000000000
   1.00000000000000   0.70000000000000   0.49000000000000
   1.00000000000000   0.80000000000000   0.64000000000000
   1.00000000000000   0.90000000000000   0.81000000000000
   1.00000000000000   1.00000000000000   1.00000000000000

  Columns 4 through 6 

                  0                  0                  0
   0.00100000000000   0.00010000000000   0.00001000000000
   0.00800000000000   0.00160000000000   0.00032000000000
   0.02700000000000   0.00810000000000   0.00243000000000
   0.06400000000000   0.02560000000000   0.01024000000000
   0.12500000000000   0.06250000000000   0.03125000000000
   0.21600000000000   0.12960000000000   0.07776000000000
   0.34300000000000   0.24010000000000   0.16807000000000
   0.51200000000000   0.40960000000000   0.32768000000000
   0.72900000000000   0.65610000000000   0.59049000000000
   1.00000000000000   1.00000000000000   1.00000000000000

  Columns 7 through 9 

                  0                  0                  0
   0.00000100000000   0.00000010000000   0.00000001000000
   0.00006400000000   0.00001280000000   0.00000256000000
   0.00072900000000   0.00021870000000   0.00006561000000
   0.00409600000000   0.00163840000000   0.00065536000000
   0.01562500000000   0.00781250000000   0.00390625000000
   0.04665600000000   0.02799360000000   0.01679616000000
   0.11764900000000   0.08235430000000   0.05764801000000
   0.26214400000000   0.20971520000000   0.16777216000000
   0.53144100000000   0.47829690000000   0.43046721000000
   1.00000000000000   1.00000000000000   1.00000000000000

  Columns 10 through 11 

                  0                  0
   0.00000000100000   0.00000000010000
   0.00000051200000   0.00000010240000
   0.00001968300000   0.00000590490000
   0.00026214400000   0.00010485760000
   0.00195312500000   0.00097656250000
   0.01007769600000   0.00604661760000
   0.04035360700000   0.02824752490000
   0.13421772800000   0.10737418240000
   0.38742048900000   0.34867844010000
   1.00000000000000   1.00000000000000

b'

ans =

   1.00000000000000
   1.11111111110000
   1.24999997440000
   1.42856889790000
   1.66659676160000
   1.99902343750000
   2.49093007360000
   3.26742244190000
   4.57050327040000
   6.86189403910000
  11.00000000000000

gauss; backsolve;
x'

ans =

   1.00000000000000
   0.99999999999967
   1.00000000000901
   0.99999999990031
   1.00000000059056
   0.99999999790967
   1.00000000463061
   0.99999999352842
   1.00000000553821
   0.99999999735233
   1.00000000054120

A*x'

ans =

   1.00000000000000
   1.11111111110000
   1.24999997440000
   1.42856889790000
   1.66659676160000
   1.99902343750000
   2.49093007360000
   3.26742244190000
   4.57050327040000
   6.86189403910000
  11.00000000000000

diary h4-3.txt
type matrix

for i = 1 : n
	sum = 0;
	for j = 1 : n
		a(i,j) = ((i-1)/(n-1))^(j-1);
		sum = sum + a(i,j);
	end
	b(i) = sum;
	b_alt1(i) = sum + (-1^i)*delta;
	b_alt2(i) = sum + delta;
end

A = a;
B = b;
B_alt1 = b_alt1;
B_alt2 = b_alt2;

type gauss

for  j = 1 : n-1
	for i = j+1 : n
		mult = a(i,j)/a(j,j);
		for k = j+1 : n
			a(i,k) = a(i,k) - mult*a(j,k);
		end
		b(i) = b(i) - mult*b(j);
	end
end

type backsolve

for i = n : -1 : 1
	for j = i+1 : n
		b(i) = b(i) - a(i,j)*x(j);
	end
	x(i) = b(i)/a(i,i);
end

n = 11; delta = 0;
matrix
A

A =

  Columns 1 through 3 

   1.00000000000000                  0                  0
   1.00000000000000   0.10000000000000   0.01000000000000
   1.00000000000000   0.20000000000000   0.04000000000000
   1.00000000000000   0.30000000000000   0.09000000000000
   1.00000000000000   0.40000000000000   0.16000000000000
   1.00000000000000   0.50000000000000   0.25000000000000
   1.00000000000000   0.60000000000000   0.36000000000000
   1.00000000000000   0.70000000000000   0.49000000000000
   1.00000000000000   0.80000000000000   0.64000000000000
   1.00000000000000   0.90000000000000   0.81000000000000
   1.00000000000000   1.00000000000000   1.00000000000000

  Columns 4 through 6 

                  0                  0                  0
   0.00100000000000   0.00010000000000   0.00001000000000
   0.00800000000000   0.00160000000000   0.00032000000000
   0.02700000000000   0.00810000000000   0.00243000000000
   0.06400000000000   0.02560000000000   0.01024000000000
   0.12500000000000   0.06250000000000   0.03125000000000
   0.21600000000000   0.12960000000000   0.07776000000000
   0.34300000000000   0.24010000000000   0.16807000000000
   0.51200000000000   0.40960000000000   0.32768000000000
   0.72900000000000   0.65610000000000   0.59049000000000
   1.00000000000000   1.00000000000000   1.00000000000000

  Columns 7 through 9 

                  0                  0                  0
   0.00000100000000   0.00000010000000   0.00000001000000
   0.00006400000000   0.00001280000000   0.00000256000000
   0.00072900000000   0.00021870000000   0.00006561000000
   0.00409600000000   0.00163840000000   0.00065536000000
   0.01562500000000   0.00781250000000   0.00390625000000
   0.04665600000000   0.02799360000000   0.01679616000000
   0.11764900000000   0.08235430000000   0.05764801000000
   0.26214400000000   0.20971520000000   0.16777216000000
   0.53144100000000   0.47829690000000   0.43046721000000
   1.00000000000000   1.00000000000000   1.00000000000000

  Columns 10 through 11 

                  0                  0
   0.00000000100000   0.00000000010000
   0.00000051200000   0.00000010240000
   0.00001968300000   0.00000590490000
   0.00026214400000   0.00010485760000
   0.00195312500000   0.00097656250000
   0.01007769600000   0.00604661760000
   0.04035360700000   0.02824752490000
   0.13421772800000   0.10737418240000
   0.38742048900000   0.34867844010000
   1.00000000000000   1.00000000000000

b'

ans =

   1.00000000000000
   1.11111111110000
   1.24999997440000
   1.42856889790000
   1.66659676160000
   1.99902343750000
   2.49093007360000
   3.26742244190000
   4.57050327040000
   6.86189403910000
  11.00000000000000

gauss; backsolve;
x'

ans =

   1.00000000000000
   0.99999999999967
   1.00000000000901
   0.99999999990031
   1.00000000059056
   0.99999999790967
   1.00000000463061
   0.99999999352842
   1.00000000553821
   0.99999999735233
   1.00000000054120

A*x'

ans =

   1.00000000000000
   1.11111111110000
   1.24999997440000
   1.42856889790000
   1.66659676160000
   1.99902343750000
   2.49093007360000
   3.26742244190000
   4.57050327040000
   6.86189403910000
  11.00000000000000

diary

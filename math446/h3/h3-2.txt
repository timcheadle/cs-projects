>> type newtq

% Tim Cheadle
% Math 446 Homework 3

format long;
steps=10;

% iterate using newton's method
for i=1:steps
  f = 0.54*x(i).^5 - 0.81*x(i).^4 - 0.09*x(i).^3 + 0.43*x(i).^2 - 0.17*x(i) + 0.02;
  fp = 2.7*x(i).^4 - 3.24*x(i).^3 - 0.27*x(i).^2 + 0.86*x(i) - 0.17;
  x(i+1) = x(i) - f/fp;
end
t = x(steps+1);
e = x - t;
for i=1:steps-1
  r(i+1) = (x(i+1) - t) / (x(i) - t)^2;
end
r(1) = 0;
r(steps+1) = 0;

% output the convergence table
a = [x' e' r']

% calculate M
fpr = 2.7*t^4 - 3.24*t^3 - 0.27*t^2 + 0.86*t - 0.17;
fppr = 10.8*t^3 - 9.72*t^2 - 0.54*t + 0.86;
m = fppr/2*fpr

% clear the vectors so we can run again
clear x e r a;

>> x(1) = -1;
>> newtq
Warning: Divide by zero.
(Type "warning off MATLAB:divideByZero" to suppress this warning.)
> In /home/u5/tcheadle/math/newtq.m at line 16
Warning: Divide by zero.
(Type "warning off MATLAB:divideByZero" to suppress this warning.)
> In /home/u5/tcheadle/math/newtq.m at line 16
Warning: Divide by zero.
(Type "warning off MATLAB:divideByZero" to suppress this warning.)
> In /home/u5/tcheadle/math/newtq.m at line 16

a =

  -1.00000000000000  -0.21922359359558                  0
  -0.86206896551724  -0.08129255911283  -1.69151639018205
  -0.79661337337312  -0.01583696696870  -2.39646129945493
  -0.78152581337515  -0.00074940697074  -2.98795262024662
  -0.78077818574327  -0.00000177933885  -3.16827743860469
  -0.78077640641448  -0.00000000001006  -3.17776484990512
  -0.78077640640442                  0                  0
  -0.78077640640442                  0                NaN
  -0.78077640640442                  0                NaN
  -0.78077640640442                  0                NaN
  -0.78077640640442                  0                  0


m =

  -7.53132534744014

>> x(1) = 1.5;
>> newtq
Warning: Divide by zero.
(Type "warning off MATLAB:divideByZero" to suppress this warning.)
> In /home/u5/tcheadle/math/newtq.m at line 16
Warning: Divide by zero.
(Type "warning off MATLAB:divideByZero" to suppress this warning.)
> In /home/u5/tcheadle/math/newtq.m at line 16

a =

   1.50000000000000   0.21922359359558                  0
   1.36792452830189   0.08714812189747   1.81335755906715
   1.30053822132687   0.01976181492246   2.60202079601726
   1.28208287019196   0.00130646378755   3.34536663556715
   1.28078260145611   0.00000619505169   3.62952825330720
   1.28077640654455   0.00000000014013   3.65137221479459
   1.28077640640442                  0                  0
   1.28077640640442  -0.00000000000000               -Inf
   1.28077640640442                  0                  0
   1.28077640640442  -0.00000000000000               -Inf
   1.28077640640442                  0                  0


m =

   3.27314409744014

>> clear
>> type newtl

% Tim Cheadle
% Math 446 Homework 3

format long;
steps=20;

% iterate using newton's method
for i=1:steps
  f = 0.54*x(i).^5 - 0.81*x(i).^4 - 0.09*x(i).^3 + 0.43*x(i).^2 - 0.17*x(i) + 0.02;
  fp = 2.7*x(i).^4 - 3.24*x(i).^3 - 0.27*x(i).^2 + 0.86*x(i) - 0.17;
  x(i+1) = x(i) - f/fp;
end
t = x(steps+1);
e = x - t;
for i=1:steps-1
  r(i+1) = (x(i+1) - t) / (x(i) - t);
end
r(1) = 0;
r(steps+1) = 0;

% print out convergence table
a = [x' e' r']

clear x e r a;

>> x(1)=0.3;
>> newtl

a =

   0.30000000000000  -0.03332327083134                  0
   0.31109947643979  -0.02222379439155   0.66691515679938
   0.31850442800006  -0.01481884283128   0.66680075284146
   0.32344423387652  -0.00987903695482   0.66665373722487
   0.32673909118127  -0.00658417965007   0.66647990894053
   0.32893647031392  -0.00438680051742   0.66626379451421
   0.33040177033793  -0.00292150049341   0.66597523224621
   0.33137881262125  -0.00194445821009   0.66556833191560
   0.33203025410303  -0.00129301672831   0.66497532402779
   0.33246458452795  -0.00085868630339   0.66409527780106
   0.33275415435624  -0.00056911647510   0.66277576904558
   0.33294720817483  -0.00037606265650   0.66078328946605
   0.33307591393817  -0.00024735689317   0.65775446961352
   0.33316171917891  -0.00016155165243   0.65311158448838
   0.33321892325639  -0.00010434757495   0.64590843474786
   0.33325705934493  -0.00006621148641   0.63452827185967
   0.33328248298577  -0.00004078784557   0.61602371106258
   0.33329943204107  -0.00002383879027   0.58445818693808
   0.33331072845615  -0.00001254237519   0.52613303989517
   0.33331826071215  -0.00000501011919   0.39945537533665
   0.33332327083134                  0                  0

>> diary off
